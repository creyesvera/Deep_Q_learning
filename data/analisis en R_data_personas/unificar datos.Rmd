---
title: "unificar datos"
author: "Camila Reyes Vera"
date: "2025-12-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
# Ruta a la carpeta
ruta_personas <- "Personas"

# Listar todos los archivos CSV
archivos_csv <- list.files(
  path = ruta_personas,
  pattern = "\\.csv$",
  full.names = TRUE
)

# Leer todos los CSV y guardarlos como data frames en una lista
dfs_personas <- lapply(archivos_csv, read.csv)

# (Opcional) asignar nombres a cada df según el nombre del archivo
names(dfs_personas) <- tools::file_path_sans_ext(basename(archivos_csv))

```


```{r}
convert_time_to_datetime <- function(df, start_time) {
  df$datetime <- as.POSIXct(start_time) + df$Time
  return(df)
}

#dfs_personas <- lapply(
#  dfs_personas,
#  convert_time_to_datetime,
#  start_time = "2025-01-01 00:00:00"
#)



```


## Including Plots

You can also embed plots, for example:

```{r}
dfs_personas[1]

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
df_total <- do.call(rbind, dfs_personas)

df_total <- df_total[order(df_total$Time), ]

row.names(df_total) <- NULL

str(df_total)

write.csv(
  df_total,
  file = "../personas.csv",
  row.names = FALSE
)

```

```{r}
any(df_total$world_z != 0, na.rm = TRUE)

```


```{r}
library(dplyr)

data_for_animation <- df_total %>%
  select(Time, ID, world_x, world_y)

min_x <- min(data_for_animation$world_x, na.rm = TRUE)
max_x <- max(data_for_animation$world_x, na.rm = TRUE)

min_y <- min(data_for_animation$world_y, na.rm = TRUE)
max_y <- max(data_for_animation$world_y, na.rm = TRUE)

unique_times <- sort(unique(data_for_animation$Time))
unique_ids <- unique(data_for_animation$ID)

cat("Valores mínimos y máximos para world_x:\n")
cat("Min X:", min_x, "Max X:", max_x, "\n\n")

cat("Valores mínimos y máximos para world_y:\n")
cat("Min Y:", min_y, "Max Y:", max_y, "\n\n")

cat("Primeras 5 unidades de tiempo únicas:\n")
print(head(unique_times, 5))

cat("\nIDs únicos:\n")
print(unique_ids)


```




```{r}
library(ggplot2)
library(gganimate)

p <- ggplot(
  data_for_animation,
  aes(x = world_x, y = world_y, color = factor(ID))
) +
  geom_point(size = 3) +
  coord_cartesian(
    xlim = c(min_x - 1, max_x + 1),
    ylim = c(min_y - 1, max_y + 1)
  ) +
  labs(
    title = "Person Position Over Time",
    subtitle = "Time: {frame_time}",
    x = "World X",
    y = "World Y",
    color = "ID"
  ) +
  theme_minimal() +
  transition_time(Time) +
  ease_aes("linear")






```


